Napier: 11/1/2022

- Goals: rfFNN vs rfLSTM vs LSTM, offline dataset
 
- Experimenters: Joey, Mender, (Eric)

- Recording Start Time: 9:20 am
- Recording Stop Time:  12:00 pm

- xPC Model: Rig_main_Cortical_Parasite_v2
- Recorded Array: Motor (Patient cable/cerebus)
- Data recorded: Spikes (250Hz highpass, RMS -4.5) + 2kSps 300-1000HzBPas continuous
- Drink: Apple Juice

- Params: 
	* Movement Mask: [0,1,0,0,0]
	* Target Hold Time (OL/CL): 750/500
	* Target Scaling(OL/CL): 100
	* Juice Time: 90
	* Trial Timeout: 5000
	* Auto Juice: 0
   	* Target Pos Style (OL/CL): 29/37/36
	* Visualization Style: MRP
	
-Decoders:	
	- all decoders trained with RR scaler, RNNs with 20 time history, no tri redist
	Run 3:
		NN0 - FNN optimized with x&y norm, TS29, pv decoding, mseloss			(corr 73 79 71 78)
	Run 4:		
		RNN0 - LSTM with x&y norm, noise, TS37, pv decoding,  msecorrloss		(corr 86 90 77 81)
		RNN1 - same as rnn0														(corr 87 90 78 81)
		
	Run 10:
		RNN2 - LSTM with x&y norm, noise, TS37, pv decoding,  msecorrloss		(corr 87 91 70 78)
		NN1 - FNN willseynet, TS37, pv decoding, msecorrloss					(corr 70 76 64 74)
		RNN3 - *NO chan 84* LSTM with x&y norm, noise, TS37, pv decoding,  msecorrloss		(corr84 90 72 77)	

-Runs:
	Run 1: calibration
	Run 2: TS29 500 warmup + 2min break
	Run 3: TS29 500 trials. BR~5.2.		Movements look pretty clean/smooth
	Run 4: TS37 500 trials. BR~3.0-3.8
	-- 5 min training break --

refit training (attempted)
	10:10am
	(All runs started with 10 hand control before switching to decoder)
	Run 5: TS37 - NN0 110 trials. V decoding. BR~1.2. (ignore first 10, had 2% pos). Having a lot of trouble without position. Somewhat giving up trial ~65
	Run 6: TS36 - NN0 40 trials. V decoding. Not working well - seems like when using norm there's not enough positional noise.
	Run 7: TS36 - NN0 240 trials. 2% pos decoding. BR~1.8-1.3. Much better with the position component. Fingers tending to move/stick together. Hard time with mrp extend. Drop in bitrate is from failed trials. Got stuck around 240.
	Run 8: TS36 - RNN0 2% pos decoding. immediately wouldn't move/stuck.
	Run 9: TS36 - RNN1 2% pos decoding. worked for a second then biased toward flex. he might be giving up since not moving much

retrain (TS37 for all decoders)
	Run 10: TS37 500 trials.
	-- 5 min training break --
	
	10:50
	Run 11: TS36 - RNN2 2% pos. 50 trials. Biased, then working trial 30-40, then still kinda biased.
	Run 12: TS36 - NN1 2% pos. 240 trials. BR~1.7. biased toward flex then suddenly working trial 40. Maybe slightly too fast
	Run 13: TS36 - RNN2 2% pos. Started in brain control. biased immediately.
	
	
*** realized afterward the gain was being changed instead of the positional component. so ignore all online runs that might've been fixed with this****
	
	
Offline
	11:10am
	500 hold time to speed things up a little. Note: finger groups weren't physically connected
	Run 14: TS6 1D finger flap. 480 trials.
	Run 15: TS12 1D random. 400 trials. 	Moving wrist/arm slightly to help hit targets.
	Run 16: TS29 2D random.	400 trials. 	ignore first 10 trials.
	Run 17: TS29 2D random 50% targets.	400 trials. 
	Run 18: TS14 1D center out. 400 trials. 
	Run 19: TS28 2D 4 target. 400 trials.
	Run 20: TS30 2D 9 target. 280 trials then he stopped.



Summary:
	- when using a normalized input, the velocity decodes seem much cleaner, making it hard to fine tune (or maintain motivation).
		-> adding position decode seems to help a lot in keeping the fingers moving a little
		
	- comparison not usable today: decoders getting biased, then occasionally randomly working when he figures it out
		- seems like with RNNs it's more stable/non moving, so he gives up before figuring out the bias

	- got a good offline set with a bunch of different target difficulties

TODO:
	
Notes:	

	Brief noise on all channels 11:01am.

	No significant juicer artifact on any channel (we changed the patient cable film last Friday).
	12 32 77 still have minimal artifact
	add 84 which is a big/active unit
	good_chans_SBP = [1, 2, 3, 4, 5, 7, 8, 9, 11, 14, 15, 17, 20, 22, 23, 24, 25, 26, 28, 29, 31, 33, 35, 36, 37, 38, 39, 40, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 71, 72, 73, 74, 75, 76, 78, 81, 82, 83, 84, 85, 86, 87, 88, 90, 91, 92, 94, 96];




	












